SELECT ROUND(MONTHS_BETWEEN(JOB_HISTORY.END_DATE, JOB_HISTORY.START_DATE)) as Miesiace, EMPLOYEES.FIRST_NAME, EMPLOYEES.LAST_NAME, JOB_HISTORY.START_DATE, JOB_HISTORY.END_DATE, CASE WHEN ROUND(MONTHS_BETWEEN(JOB_HISTORY.END_DATE, JOB_HISTORY.START_DATE)) <= 150 THEN 0.10 * EMPLOYEES.SALARY ELSE NULL END as wysokosc_dodatku FROM EMPLOYEES INNER JOIN JOB_HISTORY ON EMPLOYEES.employee_id = JOB_HISTORY.employee_id;
SELECT
  ROUND(MONTHS_BETWEEN(JOB_HISTORY.END_DATE, JOB_HISTORY.START_DATE)) as Miesiace,
  EMPLOYEES.FIRST_NAME,
  EMPLOYEES.LAST_NAME,
  JOB_HISTORY.START_DATE,
  JOB_HISTORY.END_DATE,
  CASE
    WHEN ROUND(MONTHS_BETWEEN(JOB_HISTORY.END_DATE, JOB_HISTORY.START_DATE)) <= 150 THEN
      0.10 * EMPLOYEES.SALARY
    WHEN ROUND(MONTHS_BETWEEN(JOB_HISTORY.END_DATE, JOB_HISTORY.START_DATE)) > 150
         AND ROUND(MONTHS_BETWEEN(JOB_HISTORY.END_DATE, JOB_HISTORY.START_DATE)) <= 200 THEN
      0.20 * EMPLOYEES.SALARY
    WHEN ROUND(MONTHS_BETWEEN(JOB_HISTORY.END_DATE, JOB_HISTORY.START_DATE)) > 200 THEN
      0.30 * EMPLOYEES.SALARY
    ELSE
      NULL
  END as wysokosc_dodatku
FROM EMPLOYEES
INNER JOIN JOB_HISTORY ON EMPLOYEES.employee_id = JOB_HISTORY.employee_id
ORDER BY Miesiace;
SELECT
  DEPARTMENTS.DEPARTMENT_NAME AS Nazwa_dzialu,
  SUM(EMPLOYEES.SALARY) AS Suma_wynagrodzen,
  ROUND(AVG(EMPLOYEES.SALARY)) AS Srednie_wynagrodzenie
FROM DEPARTMENTS
JOIN EMPLOYEES  ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID
JOIN JOBS ON JOBS.JOB_ID = JOBS.JOB_ID
WHERE JOBS.MIN_SALARY > 5000
GROUP BY DEPARTMENTS.DEPARTMENT_NAME;

SELECT EMPLOYEES.LAST_NAME AS Nazwisko, DEPARTMENTS.DEPARTMENT_ID AS Numer_departamentu, DEPARTMENTS.DEPARTMENT_NAME AS Nazwa_departamentu, EMPLOYEES.JOB_ID AS Id_pracy FROM EMPLOYEES 
JOIN DEPARTMENTS ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID
JOIN LOCATIONS ON DEPARTMENTS.LOCATION_ID = LOCATIONS.LOCATION_ID WHERE LOCATIONS.CITY = 'Toronto';

SELECT
  P1.FIRST_NAME AS Imie_Jennifer,
  P1.LAST_NAME AS Nazwisko_Jennifer,
  P2.FIRST_NAME AS Imie_Wspolpracownika,
  P2.LAST_NAME AS Nazwisko_Wspolpracownika 
FROM EMPLOYEES P1 JOIN EMPLOYEES P2 ON P1.DEPARTMENT_ID = P2.DEPARTMENT_ID WHERE P1.FIRST_NAME = 'Jennifer' AND P1.EMPLOYEE_ID <> P2.EMPLOYEE_ID;

SELECT DEPARTMENTS.DEPARTMENT_NAME FROM DEPARTMENTS LEFT JOIN EMPLOYEES ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID WHERE EMPLOYEES.DEPARTMENT_ID IS NULL;

SELECT
  EMPLOYEES.FIRST_NAME AS Imie,
  EMPLOYEES.LAST_NAME AS Nazwisko,
  EMPLOYEES.JOB_ID AS Id_pracy,
  DEPARTMENTS.DEPARTMENT_NAME AS Nazwa_departamentu,
  EMPLOYEES.SALARY AS Zarobki,
  JOB_GRADES.grade AS Grade
FROM EMPLOYEES JOIN DEPARTMENTS ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID JOIN JOBS ON EMPLOYEES.JOB_ID = JOBS.JOB_ID JOIN JOB_GRADES ON EMPLOYEES.SALARY BETWEEN JOB_GRADES.min_salary AND JOB_GRADES.max_salary;

SELECT
  FIRST_NAME AS Imie,
  LAST_NAME AS Nazwisko,
  SALARY AS Zarobki
FROM EMPLOYEES WHERE SALARY > (SELECT AVG(SALARY) FROM EMPLOYEES) ORDER BY SALARY DESC;

SELECT
  EMPLOYEES.EMPLOYEE_ID AS Id,
  EMPLOYEES.FIRST_NAME AS Imie,
  EMPLOYEES.LAST_NAME AS Nazwisko
FROM EMPLOYEES  WHERE EMPLOYEES.DEPARTMENT_ID IN (
  SELECT DISTINCT DEPARTMENTS.DEPARTMENT_ID
  FROM EMPLOYEES JOIN DEPARTMENTS ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID WHERE EMPLOYEES.LAST_NAME LIKE '%u%' );